% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design.R
\name{cbc_design}
\alias{cbc_design}
\title{Generate experimental designs for choice experiments}
\usage{
cbc_design(
  profiles,
  priors = NULL,
  n_alts,
  n_q,
  n_blocks = 1,
  n_start = 5,
  no_choice = FALSE,
  label = NULL,
  method = "sequential",
  prior_no_choice = NULL,
  max_iter = 50,
  parallel = FALSE,
  remove_dominant = FALSE,
  dominance_types = c("total", "partial"),
  dominance_threshold = 0.8,
  max_dominance_replacements = 10,
  ...
)
}
\arguments{
\item{profiles}{A data frame of class \code{cbc_profiles} created using the
\code{cbc_profiles()} function.}

\item{priors}{A \code{cbc_priors} object created by \code{cbc_priors()}, or \code{NULL} for
random designs. Required for D-efficient designs.}

\item{n_alts}{Number of alternatives per choice question.}

\item{n_q}{Number of questions per respondent (or per block).}

\item{n_blocks}{Number of blocks in the design. Each block contains \code{n_q} questions.
Defaults to \code{1}. When \code{n_blocks > 1}, the design will contain multiple versions
that can be distributed across respondents.}

\item{n_start}{A numeric value indicating the number of random start designs
to use in obtaining a D-efficient design. Defaults to \code{5}.}

\item{no_choice}{Include a "no choice" option in the choice sets? Defaults to
\code{FALSE}. If \code{TRUE}, the total number of alternatives per question will be
one more than the provided \code{n_alts} argument.}

\item{label}{The name of the variable to use in a "labeled" design (also
called an "alternative-specific" design). If used, the \code{n_alts} argument
will be ignored. Defaults to \code{NULL}.}

\item{method}{Choose the design method to use. Currently supports \code{"sequential"}
for D-efficient designs and \code{"random"} for random designs. Defaults to \code{"sequential"}.}

\item{prior_no_choice}{Prior utility value for the "no choice" alternative.
Only required if \code{no_choice = TRUE} and using D-efficient methods. Defaults to \code{NULL}.}

\item{max_iter}{Maximum number of iterations for D-efficient optimization.
Defaults to \code{50}.}

\item{parallel}{Logical value indicating whether to use parallel processing.
Defaults to \code{FALSE}.}

\item{remove_dominant}{Logical. If \code{TRUE}, removes choice sets where one
alternative dominates others based on the provided priors. Only works when
\code{priors} are provided. Defaults to \code{FALSE}.}

\item{dominance_types}{Character vector specifying which types of dominance
to check for. Options are \code{"total"} and/or \code{"partial"}. Defaults to \code{c("total", "partial")}.}

\item{dominance_threshold}{Numeric. Threshold for total dominance detection.
Defaults to \code{0.8}.}

\item{max_dominance_replacements}{Integer. Maximum number of replacement
attempts when removing dominant choice sets. Defaults to \code{10}.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A \code{cbc_design} object containing the experimental design with these components:
\itemize{
\item \strong{Design data}: Each row is an alternative, with columns for \code{profileID}, \code{blockID},
\code{respID}, \code{qID}, \code{altID}, \code{obsID}, and attribute values
\item \strong{Metadata}: Stored as attributes including design parameters, efficiency metrics,
and the original profiles
\item \strong{D-error}: Design efficiency measure (lower is better)
}
}
\description{
This function creates experimental designs (DOE) for choice-based conjoint experiments.
The design represents the choice questions that will be shown to a single respondent
(or single block). To create a complete survey with multiple respondents, pass the
result to \code{cbc_survey()} or use \code{cbc_survey()} directly with profiles.
}
\details{
\strong{Purpose:} Generate experimental designs for choice experiments

\strong{When to use \code{cbc_design()}:}
\itemize{
\item You need just the experimental design for use in external survey platforms (Qualtrics, etc.)
\item You want to inspect or modify the design before creating the full survey
\item You're conducting pure experimental design research
\item You need to optimize computational performance (no survey replication overhead)
}

\strong{When to use \code{cbc_survey()} instead:}
\itemize{
\item You want to create a complete survey for choice analysis within R
\item You're conducting choice simulation or power analysis
\item You want the simplest workflow (profiles → complete survey)
}

\strong{Design methods:}
\itemize{
\item \code{"sequential"}: Creates D-efficient designs using sequential optimization
\item \code{"random"}: Creates random designs by sampling from profiles
}

\strong{Typical workflows:}

\if{html}{\out{<div class="sourceCode r">}}\preformatted{# DOE for external use
design <- cbc_design(profiles, method = "sequential", n_alts = 3, n_q = 6, priors = priors)
# → Export to Qualtrics, save as CSV, etc.

# DOE → Survey (two-step)
design <- cbc_design(profiles, method = "sequential", n_alts = 3, n_q = 6, priors = priors)
survey <- cbc_survey(design, n_resp = 100)

# Profiles → Survey (integrated, often easier)
survey <- cbc_survey(profiles, n_resp = 100, method = "sequential", n_alts = 3, n_q = 6, priors = priors)
}\if{html}{\out{</div>}}
}
\examples{
library(cbcTools)

# Create profiles
profiles <- cbc_profiles(
  price = c(1, 2, 3, 4),
  type = c("A", "B", "C"),
  quality = c("Low", "High")
)

# Create priors
priors <- cbc_priors(
  profiles = profiles,
  price = -0.5,
  type = c(0.2, 0.3),
  quality = 0.4
)

# Generate D-efficient design
design <- cbc_design(
  profiles = profiles,
  n_alts = 3,
  n_q = 6,
  priors = priors,
  method = "sequential"
)

# Inspect the design
print(design)
cbc_inspect_balance(design)

# Check D-error
d_error <- cbc_error(design, priors = priors)

# Convert to survey for analysis
survey <- cbc_survey(design, n_resp = 100)

# Or create survey directly (alternative approach)
survey2 <- cbc_survey(
  profiles, n_resp = 100, method = "sequential",
  n_alts = 3, n_q = 6, priors = priors
)
}
