<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate survey designs for choice experiments (Updated Implementation) â€” cbc_design â€¢ cbcTools</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="â€image/svg+xmlâ€" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate survey designs for choice experiments (Updated Implementation) â€” cbc_design"><meta name="description" content="This function creates experimental designs for choice-based conjoint experiments
using multiple design approaches including optimization and frequency-based methods."><meta property="og:description" content="This function creates experimental designs for choice-based conjoint experiments
using multiple design approaches including optimization and frequency-based methods."><meta property="og:image" content="https://jhelvy.github.io/cbcTools/reference/figures/logo.png"><meta property="og:image:alt" content="Logo for the cbcTools package"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cbcTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/profiles.html">Generating Profiles</a></li>
    <li><a class="dropdown-item" href="../articles/priors.html">Specifying Priors</a></li>
    <li><a class="dropdown-item" href="../articles/design.html">Generating Designs</a></li>
    <li><a class="dropdown-item" href="../articles/d_error.html">Computing D-Error</a></li>
    <li><a class="dropdown-item" href="../articles/choices.html">Simulating Choices</a></li>
    <li><a class="dropdown-item" href="../articles/power.html">Power Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jhelvy/cbcTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate survey designs for choice experiments (Updated Implementation)</h1>
      <small class="dont-index">Source: <a href="https://github.com/jhelvy/cbcTools/blob/main/R/design.R" class="external-link"><code>R/design.R</code></a></small>
      <div class="d-none name"><code>cbc_design.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates experimental designs for choice-based conjoint experiments
using multiple design approaches including optimization and frequency-based methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cbc_design</span><span class="op">(</span></span>
<span>  <span class="va">profiles</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n_alts</span>,</span>
<span>  <span class="va">n_q</span>,</span>
<span>  n_resp <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_blocks <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  no_choice <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  balance_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  randomize_questions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  randomize_alts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_dominant <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dominance_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"total"</span>, <span class="st">"partial"</span><span class="op">)</span>,</span>
<span>  dominance_threshold <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  max_dominance_attempts <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_start <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  include_probs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_idefix <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-profiles">profiles<a class="anchor" aria-label="anchor" href="#arg-profiles"></a></dt>
<dd><p>A data frame of class <code>cbc_profiles</code> created using <code><a href="cbc_profiles.html">cbc_profiles()</a></code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Choose the design method: "random", "shortcut", "minoverlap", "balanced", "stochastic", "modfed", or "cea". Defaults to "random"</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>A <code>cbc_priors</code> object created by <code><a href="cbc_priors.html">cbc_priors()</a></code>, or NULL for random/shortcut designs</p></dd>


<dt id="arg-n-alts">n_alts<a class="anchor" aria-label="anchor" href="#arg-n-alts"></a></dt>
<dd><p>Number of alternatives per choice question</p></dd>


<dt id="arg-n-q">n_q<a class="anchor" aria-label="anchor" href="#arg-n-q"></a></dt>
<dd><p>Number of questions per respondent (or per block)</p></dd>


<dt id="arg-n-resp">n_resp<a class="anchor" aria-label="anchor" href="#arg-n-resp"></a></dt>
<dd><p>Number of respondents (for random/shortcut designs) or 1 (for optimized designs that get repeated)</p></dd>


<dt id="arg-n-blocks">n_blocks<a class="anchor" aria-label="anchor" href="#arg-n-blocks"></a></dt>
<dd><p>Number of blocks in the design. Defaults to 1</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Number of cores to use for parallel processing in the design search.
Defaults to NULL, in which case it is set to the number of available cores minus 1.</p></dd>


<dt id="arg-no-choice">no_choice<a class="anchor" aria-label="anchor" href="#arg-no-choice"></a></dt>
<dd><p>Include a "no choice" option? Defaults to FALSE</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>The name of the variable to use in a "labeled" design. Defaults to NULL</p></dd>


<dt id="arg-balance-by">balance_by<a class="anchor" aria-label="anchor" href="#arg-balance-by"></a></dt>
<dd><p>Character vector of attribute names to balance sampling across.
Ensures balanced representation across levels of specified attributes.
Only compatible with "random", "shortcut", "minoverlap", and "balanced" methods.
Cannot be used with labeled designs or D-optimal methods ("stochastic", "modfed", "cea").
Defaults to NULL</p></dd>


<dt id="arg-randomize-questions">randomize_questions<a class="anchor" aria-label="anchor" href="#arg-randomize-questions"></a></dt>
<dd><p>Randomize question order for each respondent? Defaults to TRUE (optimized methods only)</p></dd>


<dt id="arg-randomize-alts">randomize_alts<a class="anchor" aria-label="anchor" href="#arg-randomize-alts"></a></dt>
<dd><p>Randomize alternative order within questions? Defaults to TRUE (optimized methods only)</p></dd>


<dt id="arg-remove-dominant">remove_dominant<a class="anchor" aria-label="anchor" href="#arg-remove-dominant"></a></dt>
<dd><p>Remove choice sets with dominant alternatives? Defaults to FALSE</p></dd>


<dt id="arg-dominance-types">dominance_types<a class="anchor" aria-label="anchor" href="#arg-dominance-types"></a></dt>
<dd><p>Types of dominance to check: "total" and/or "partial"</p></dd>


<dt id="arg-dominance-threshold">dominance_threshold<a class="anchor" aria-label="anchor" href="#arg-dominance-threshold"></a></dt>
<dd><p>Threshold for total dominance detection. Defaults to 0.8</p></dd>


<dt id="arg-max-dominance-attempts">max_dominance_attempts<a class="anchor" aria-label="anchor" href="#arg-max-dominance-attempts"></a></dt>
<dd><p>Maximum attempts to replace dominant choice sets. Defaults to 50.</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum iterations for optimized designs. Defaults to 50</p></dd>


<dt id="arg-n-start">n_start<a class="anchor" aria-label="anchor" href="#arg-n-start"></a></dt>
<dd><p>Number of random starts for optimized designs. Defaults to 5</p></dd>


<dt id="arg-include-probs">include_probs<a class="anchor" aria-label="anchor" href="#arg-include-probs"></a></dt>
<dd><p>Include predicted probabilities in resulting design? Requires <code>priors</code>. Defaults to <code>FALSE</code></p></dd>


<dt id="arg-use-idefix">use_idefix<a class="anchor" aria-label="anchor" href="#arg-use-idefix"></a></dt>
<dd><p>If <code>TRUE</code> (the default), the idefix package will be used to find optimal designs, which is faster.
Only valid with <code>"cea"</code> and <code>"modfed"</code> methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>cbc_design</code> object containing the experimental design</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="design-methods">Design Methods<a class="anchor" aria-label="anchor" href="#design-methods"></a></h3>


<p>The <code>method</code> argument determines the design approach used:</p><ul><li><p><code>"random"</code>: Creates designs by randomly sampling profiles for each respondent independently</p></li>
<li><p><code>"shortcut"</code>: Frequency-based greedy algorithm that balances attribute level usage</p></li>
<li><p><code>"minoverlap"</code>: Greedy algorithm that minimizes attribute overlap within choice sets</p></li>
<li><p><code>"balanced"</code>: Greedy algorithm that maximizes overall attribute balance across the design</p></li>
<li><p><code>"stochastic"</code>: Stochastic profile swapping with D-error optimization (first improvement found)</p></li>
<li><p><code>"modfed"</code>: Modified Fedorov algorithm with exhaustive profile swapping for D-error optimization</p></li>
<li><p><code>"cea"</code>: Coordinate Exchange Algorithm with attribute-by-attribute D-error optimization</p></li>
</ul></div>

<div class="section">
<h3 id="method-compatibility">Method Compatibility<a class="anchor" aria-label="anchor" href="#method-compatibility"></a></h3>


<p>The table below summarizes method compatibility with design features:</p><table class="table table"><tr><td>Method</td><td>No choice?</td><td>Labeled designs?</td><td>Restricted profiles?</td><td>balance_by?</td><td>Blocking?</td><td>Interactions?</td><td>Dominance removal?</td></tr><tr><td>"random"</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td></tr><tr><td>"shortcut"</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>"minoverlap"</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>"balanced"</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>"stochastic"</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>"modfed"</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>"cea"</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td></tr></table></div>

<div class="section">
<h3 id="design-quality-assurance">Design Quality Assurance<a class="anchor" aria-label="anchor" href="#design-quality-assurance"></a></h3>


<p>All methods ensure the following criteria are met:</p><ol><li><p>No duplicate profiles within any choice set</p></li>
<li><p>No duplicate choice sets within any respondent</p></li>
<li><p>If <code>remove_dominant = TRUE</code>, choice sets with dominant alternatives are eliminated (optimization methods only)</p></li>
</ol></div>

<div class="section">
<h3 id="balanced-sampling-with-balance-by">Balanced Sampling with balance_by<a class="anchor" aria-label="anchor" href="#balanced-sampling-with-balance-by"></a></h3>


<p>The <code>balance_by</code> argument enables balanced sampling across specified attributes,
solving the problem of attribute-specific features that create imbalanced designs.
For example, consider an experiment on alternative vehicle powertrains with a "powertrain"
attribute for gas and electric vehicles. If you had an "electric_vehicle_range" attribute,
it should be 0 for non-electric powertrains, but using restrictions can lead to
over-representation of electric vehicles. Using <code>balance_by = "powertrain"</code> ensures that each
choice question samples proportionally from gas and electric powertrains, maintaining balance
even when electric vehicles have additional attributes.</p>
<p>Multiple attributes can be balanced simultaneously using <code>balance_by = c("attr1", "attr2")</code>,
which creates groups based on unique combinations of the specified attributes.</p>
</div>

<div class="section">
<h3 id="method-details">Method Details<a class="anchor" aria-label="anchor" href="#method-details"></a></h3>

<div class="section">
<h4 id="random-method">Random Method<a class="anchor" aria-label="anchor" href="#random-method"></a></h4>


<p>Creates designs where each respondent sees completely independent, randomly generated choice sets.</p>
</div>

<div class="section">
<h4 id="greedy-methods-shortcut-minoverlap-balanced-">Greedy Methods (shortcut, minoverlap, balanced)<a class="anchor" aria-label="anchor" href="#greedy-methods-shortcut-minoverlap-balanced-"></a></h4>


<p>These methods use frequency-based algorithms that make locally optimal choices:</p><ul><li><p><strong>Shortcut</strong>: Balances attribute level usage within questions and across the overall design</p></li>
<li><p><strong>Minoverlap</strong>: Minimizes attribute overlap within choice sets while allowing some overlap for balance</p></li>
<li><p><strong>Balanced</strong>: Maximizes overall attribute balance, prioritizing level distribution over overlap reduction</p></li>
</ul><p>These methods provide good level balance without requiring priors or D-error calculations and offer fast execution suitable for large designs.</p>
</div>

<div class="section">
<h4 id="d-error-optimization-methods-stochastic-modfed-cea-">D-Error Optimization Methods (stochastic, modfed, cea)<a class="anchor" aria-label="anchor" href="#d-error-optimization-methods-stochastic-modfed-cea-"></a></h4>


<p>These methods minimize D-error to create statistically efficient designs:</p><ul><li><p><strong>Stochastic</strong>: Random profile sampling with first improvement acceptance</p></li>
<li><p><strong>Modfed</strong>: Exhaustive profile testing for best improvement (slower but thorough)</p></li>
<li><p><strong>CEA</strong>: Coordinate exchange testing attribute levels individually (requires full factorial profiles)</p></li>
</ul></div>


</div>

<div class="section">
<h3 id="idefix-integration">idefix Integration<a class="anchor" aria-label="anchor" href="#idefix-integration"></a></h3>


<p>When <code>use_idefix = TRUE</code> (the default), the function leverages the highly optimized
algorithms from the idefix package for 'cea' and 'modfed' design generation methods.
This can provide significant speed improvements, especially for larger
problems.</p>
<p>Key benefits of idefix integration:</p><ul><li><p>Faster optimization algorithms with C++ implementation</p></li>
<li><p>Better handling of large candidate sets</p></li>
<li><p>Optimized parallel processing</p></li>
<li><p>Advanced blocking capabilities for multi-block designs</p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhelvy/cbcTools" class="external-link">cbcTools</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create profiles for an apple choice experiment</span></span></span>
<span class="r-in"><span><span class="va">profiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="cbc_profiles.html">cbc_profiles</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fuji"</span>, <span class="st">"Gala"</span>, <span class="st">"Honeycrisp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    freshness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Poor"</span>, <span class="st">"Average"</span>, <span class="st">"Excellent"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic random design</span></span></span>
<span class="r-in"><span><span class="va">design_random</span> <span class="op">&lt;-</span> <span class="fu">cbc_design</span><span class="op">(</span></span></span>
<span class="r-in"><span>    profiles <span class="op">=</span> <span class="va">profiles</span>,</span></span>
<span class="r-in"><span>    n_alts <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    n_q <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>    n_resp <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">design_random</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design method: random</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Structure: 100 respondents Ã— 6 questions Ã— 3 alternatives</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile usage: 45/45 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ðŸ’¡ Use cbc_inspect() for a more detailed summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First few rows of design:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   profileID respID qID altID obsID price typeGala typeHoneycrisp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        22      1   1     1     1   1.5        1              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         9      1   1     2     1   2.5        1              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        34      1   1     3     1   2.5        0              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        18      1   2     1     2   2.0        0              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         3      1   2     2     2   2.0        0              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         7      1   2     3     2   1.5        1              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   freshnessAverage freshnessExcellent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                1                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                0                  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                1                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                0                  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                0                  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect design</span></span></span>
<span class="r-in"><span><span class="fu"><a href="cbc_inspect.html">cbc_inspect</a></span><span class="op">(</span><span class="va">design_random</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DESIGN SUMMARY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =========================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STRUCTURE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method: random</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Created: 2025-09-23 15:54:11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Respondents: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Questions per respondent: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternatives per question: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total choice sets: 600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile usage: 45/45 (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SUMMARY METRICS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D-error calculation not available for random designs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall balance score: 0.736 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall overlap score: 0.255 (lower is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VARIABLE ENCODING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Format: Dummy-coded (type, freshness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ðŸ’¡ Use cbc_decode_design() to convert to categorical format</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ATTRIBUTE BALANCE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall balance score: 0.736 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual attribute level counts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> price:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 1.5   2 2.5   3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 380 350 361 381 328 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balance score: 0.942 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typeGala:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1180  620 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balance score: 0.694 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typeHoneycrisp:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1223  577 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balance score: 0.663 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> freshnessAverage:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1194  606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balance score: 0.684 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> freshnessExcellent:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1179  621 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balance score: 0.695 (higher is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ATTRIBUTE OVERLAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall overlap score: 0.255 (lower is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counts of attribute overlap:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (# of questions with N unique levels)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> price: Continuous variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Questions by # unique levels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 (complete overlap):   2.5%  (15 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 (partial overlap):   47.2%  (283 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3 (partial overlap):   50.3%  (302 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4 (partial overlap):    0.0%  (0 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5 (no overlap):         0.0%  (0 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Average unique levels per question: 2.48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typeGala: Continuous variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Questions by # unique levels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 (complete overlap):  29.2%  (175 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 (no overlap):        70.8%  (425 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Average unique levels per question: 1.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typeHoneycrisp: Continuous variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Questions by # unique levels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 (complete overlap):  33.8%  (203 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 (no overlap):        66.2%  (397 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Average unique levels per question: 1.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> freshnessAverage: Continuous variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Questions by # unique levels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 (complete overlap):  28.8%  (173 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 (no overlap):        71.2%  (427 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Average unique levels per question: 1.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> freshnessExcellent: Continuous variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Questions by # unique levels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 (complete overlap):  33.0%  (198 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 (no overlap):        67.0%  (402 / 600 questions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Average unique levels per question: 1.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Greedy design with balanced frequency</span></span></span>
<span class="r-in"><span><span class="va">design_balanced</span> <span class="op">&lt;-</span> <span class="fu">cbc_design</span><span class="op">(</span></span></span>
<span class="r-in"><span>    profiles <span class="op">=</span> <span class="va">profiles</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"balanced"</span>,</span></span>
<span class="r-in"><span>    n_alts <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    n_q <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>    n_resp <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating balanced design for 100 respondents using 3 cores...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Design with priors using D-optimal method</span></span></span>
<span class="r-in"><span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="cbc_priors.html">cbc_priors</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    profiles <span class="op">=</span> <span class="va">profiles</span>,</span></span>
<span class="r-in"><span>    price <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gala"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"Honeycrisp"</span> <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    freshness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Average"</span> <span class="op">=</span> <span class="fl">0.6</span>, <span class="st">"Excellent"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">design_optimal</span> <span class="op">&lt;-</span> <span class="fu">cbc_design</span><span class="op">(</span></span></span>
<span class="r-in"><span>    profiles <span class="op">=</span> <span class="va">profiles</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"stochastic"</span>,</span></span>
<span class="r-in"><span>    priors <span class="op">=</span> <span class="va">priors</span>,</span></span>
<span class="r-in"><span>    n_alts <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    n_q <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>    n_resp <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    n_start <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stochastic design will be optimized into 1 design block, then allocated across 100 respondents</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running 3 design searches using 3 cores...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> D-error results from all starts:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Start 3: 0.847233   (Best)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Start 2: 0.951922 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Start 1: 1.012667 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare designs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="cbc_compare.html">cbc_compare</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Random"</span> <span class="op">=</span> <span class="va">design_random</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Balanced"</span> <span class="op">=</span> <span class="va">design_balanced</span>,</span></span>
<span class="r-in"><span>    <span class="st">"D-optimal"</span> <span class="op">=</span> <span class="va">design_optimal</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CBC Design Comparison</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =====================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Designs compared: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metrics: structure, efficiency, balance, overlap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sorted by: d_error (ascending)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Structure</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =====================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Design     Method respondents questions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  D-optimal stochastic         100         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Random     random         100         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balanced   balanced         100         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Alternatives Blocks Profile Usage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             3      1 (16/45) 35.6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             3      1  (45/45) 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             3      1  (45/45) 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  No Choice Labeled?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         No       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         No       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         No       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design Metrics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =====================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Design     Method D-Error (Null) D-Error (Prior) Balance Overlap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  D-optimal stochastic       0.739652        0.847233   0.654   0.067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Random     random             NA              NA   0.736   0.255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Balanced   balanced             NA              NA   0.741   0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interpretation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - D-Error: Lower is better (design efficiency)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Balance: Higher is better (level distribution)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Overlap: Lower is better (attribute variation)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Profile Usage: Higher means more profiles used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best performers:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - D-Error: D-optimal (0.847233)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Balance: Balanced (0.741)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Overlap: Balanced (0.000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Profile Usage: Random (100.0%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use summary() for detailed information on any one design.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Helveston.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

